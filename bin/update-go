#!/bin/csh -e

unsetenv CFLAGS
pushd $GOROOT/src
set old=`git rev-parse HEAD`
git pull --rebase
set new=`git rev-parse HEAD`
if($new != $old || "$1" == "-f") then
	./make.bash
	rehash
	go get -u golang.org/x/tools/cmd/vet
	go get -u golang.org/x/tools/cmd/cover
	go get -u golang.org/x/tools/cmd/godoc
	go get -u golang.org/x/tools/cmd/oracle
	go get -u golang.org/x/tools/cmd/goimports
	rm -rf `go env GOROOT`/pkg/*_race
	go install -race std
endif
popd
